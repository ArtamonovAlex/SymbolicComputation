using System;
using System.Linq;
using System.Windows;
using OxyPlot;
using OxyPlot.Series;
using SymbolicComputationLib;
using SymbolicComputationLib.Model;
using Expression = SymbolicComputationLib.Model.Expression;
using static SymbolicComputationLib.PredefinedSymbols;

namespace SymbolicComputationPlots
{
	/// <summary>
	/// Interaction logic for MainWindow.xaml
	/// </summary>
	public partial class MainWindow : Window
	{

		public MainWindow(Expression expression, decimal width, decimal height)
		{
			InitializeComponent();
			DataContext = this;

			Width = (double)width < MinWidth ? MinWidth : (double)width;
			Height = (double)height < MinHeight ? MinHeight : (double)height;
			Plot.Model = new PlotModel();
			DrawPlot(expression);
		}

		public MainWindow()
		{
			InitializeComponent();
			Plot.Model = new PlotModel();
			var expression = L[
				L[-8.1981651968155569m, 8.6255485278167695m], L[-8.9425422421642686m, 7.6987621243358136m],
				L[-9.5845413491216766m, 6.7101838370477469m], L[-10.1193235952018376m, 5.6709161495821248m],
				L[-10.5432357508753205m, 4.5924045881721395m], L[-10.8538298941318824m, 3.4863127555124946m],
				L[-11.0498700075190708m, 2.3643969245730347m], L[-11.1313256702104240m, 1.238381533984784m],
				L[-11.0993530945526226m, 0.11983689934676814m], L[-10.9562638890819070m, -0.9799395863010490m],
				L[-10.7054820568000362m, -2.050037543932392m], L[-10.3514898572522712m, -3.0800418398462268m],
				L[-9.8997632724333976m, -4.0601338832332478m], L[-9.3566979186493244m, -4.9811850055125812m],
				L[-8.7295263381761715m, -5.8348410356314365m], L[-8.0262276850093104m, -6.6135972925776208m],
				L[-7.2554308874328128m, -7.310863330529836m], L[-6.4263124259580984m, -7.9210168920395886m],
				L[-5.5484899079139827m, -8.4394466490272208m], L[-4.6319126493034500m, -8.8625834387735200m],
				L[-3.6867504903080544m, -9.1879198310723868m], L[-2.7232820730025526m, -9.4140179918493296m],
				L[-1.7517837985740601m, -9.5405059364298582m], L[-0.78242065689858336m, -9.5680623908740416m],
				L[0.17485991586401110m, -9.4983906010346810m], L[1.1104300453830798m, -9.3341815449620742m],
				L[2.015078247602634m, -9.079067113753413m], L[2.880100103747324m, -8.7375639278001632m],
				L[3.6973818895141947m, -8.3150085485880595m], L[4.4594763562516050m, -7.8174849298244850m],
				L[5.1596699597858127m, -7.2517450248946168m], L[5.7920409369231640m, -6.6251235297921960m],
				L[6.35150773930191m, -5.9454477911750232m], L[6.8338674479136142m, -5.2209439476350130m],
				L[7.2358239079523790m, -4.4601403983624410m], L[7.5550054413554952m, -3.6717697069790352m],
				L[7.7899721121463964m, -2.8646700494090809m], L[7.9402126361669974m, -2.0476873033873942m],
				L[8.006131140706953m, -1.2295788538366836m], L[7.9890240896599920m, -0.41892015328980720m],
				L[7.8910477949742706m, 0.37598496968852362m], L[7.715177034196086m, 1.1471893178605314m],
				L[7.4651553857943293m, 1.8871817787234874m], L[7.1454379777495804m, 2.5889604296191964m],
				L[6.7611274197476625m, 3.2460985835208900m], L[6.3179037544956182m, 3.8528031547082846m],
				L[5.8219493185554392m, 4.4039648195883492m], L[5.2798694471687232m, 4.8951995486245704m],
				L[4.6986099904505698m, 5.3228811895098797m], L[4.0853726298210490m, 5.6841648881352020m],
				L[3.4475289935066238m, 5.9770012413359232m], L[2.7925345684015188m, 6.2001411826088688m],
				L[2.1278433926826345m, 6.3531317077656182m], L[1.460824489597176m, 6.4363026506367138m],
				L[0.798680968192575m, 6.4507448183172605m], L[0.14837267195122816m, 6.3982798899562112m],
				L[-0.48345679804286907m, 6.2814225717130482m], L[-1.0905479219098008m, 6.1033355822876262m],
				L[-1.6670872693597732m, 5.8677781175107956m], L[-2.2077630634343100m, 5.5790485081002060m],
				L[-2.707813769628371m, 5.2419218411772428m], L[-3.1630692697137516m, 4.8615833629582558m],
				L[-3.5699842728334392m, 4.4435585167433016m], L[-3.9256637125193488m, 3.9936404966156888m],
				L[-4.2278799760546580m, 3.5178162129474705m], L[-4.4750819109051090m, 3.022191570812454m],
				L[-4.6663956506310802m, 2.5129169567996686m], L[-4.8016173986326988m, 1.996113813675904m],
				L[-4.8811984011741267m, 1.4778031561663245m], L[-4.9062224303218100m, 0.9638368452218200m],
				L[-4.8783761817132895m, 0.45983239304389527m], L[-4.7999130705113088m, -0.02888798253111168m],
				L[-4.673610980632258m, -0.4973533972072246m], L[-4.5027245865942362m, -0.9409948444490790m],
				L[-4.2909329234275830m, -1.3556897309654640m], L[-4.0422829274507900m, -1.7377999696282324m],
				L[-3.7611297088647495m, -2.0842032801756536m], L[-3.4520743456987284m, -2.3923174354104186m],
				L[-3.1199000074069734m, -2.6601172800803279m], L[-2.769507225238240m, -2.8861444401403720m],
				L[-2.4058491253720755m, -3.0695097305508636m], L[-2.0338674298430008m, -3.2098883590903608m],
				L[-1.6584300096801645m, -3.3075081107976504m], L[-1.2842707448099844m, -3.3631307815821264m],
				L[-0.9159324065453205m, -3.378027209280605m], L[-0.5577132314602236m, -3.3539463250705424m],
				L[-0.21361780076196747m, -3.2930787168237585m], L[0.11268722235324544m, -3.1980152579245632m],
				L[0.4179120126366876m, -3.0717014095927277m], L[0.6991767483210420m, -2.917387851247620m],
				L[0.9540386879283483m, -2.7385781314280512m], L[1.1805129047694976m, -2.5389740608506988m],
				L[1.3770865086581358m, -2.322419589064764m], L[1.5427262688036602m, -2.0928439166701222m],
				L[1.6768796365895925m, -1.8542045961519875m], L[1.779469250949744m, -1.6104313661017512m],
				L[1.8508810913059741m, -1.3653714461076175m], L[1.8919465225346092m, -1.1227369931863822m],
				L[1.9039185522293958m, -0.8860553856710766m], L[1.8884426917221180m, -0.6586229574508640m],
				L[1.8475228780628764m, -0.4434627549572405m], L[1.7834829736755834m, -0.2432868319685610m],
				L[1.698924412994125m, -0.06046353390739173m], L[1.5966806104415952m, 0.10300984535400080m],
				L[1.479768781123215m, 0.2455287242118780m], L[1.3513398541467804m, 0.3658969781161898m],
				L[1.2146271782507174m, 0.4633366139802686m], L[1.0728947302044324m, 0.5374913003012772m],
				L[0.9293855381536286m, 0.5884237601175615m], L[0.7872710247302820m, 0.6166071144741450m],
				L[0.6496019584583715m, 0.6229103431209408m], L[0.5192616769959392m, 0.6085781057541960m],
				L[0.3989222124005258m, 0.5752052402868646m], L[0.2910039073281012m, 0.5247063234989436m],
				L[0.197639062410455m, 0.4592807431294245m], L[0.1206400996266736m, 0.3813737882472604m],
				L[0.0614726649958713m, 0.2936343158731713m], L[0.0212340271488396m, 0.1988695956928618m],
				L[0.000637057126765214m, 0.0999979707704973m], L[0, 0]
			];
			DrawPlot(expression);
		}

		public void DrawPlot(Expression expression)
		{
			Plot.Model.Series.Clear();

			LineSeries newLine = new LineSeries();
			foreach (Expression point in expression.Args)
			{
				newLine.Points.Add(new DataPoint(Convert.ToDouble(point.Args[0].ToString()),
					Convert.ToDouble(point.Args[1].ToString())));
			}

			Plot.Model.Series.Add(newLine);

			Plot.Model.InvalidatePlot(true);

		}
	}
}